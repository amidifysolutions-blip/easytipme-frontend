<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pTitle">Welcome</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root { --apple-bg: #F5F5F7; --apple-blue: #007AFF; }
        body { font-family: 'Inter', sans-serif; background: var(--apple-bg); margin: 0; padding: 20px; display: flex; justify-content: center; color: #1D1D1F; }
        .triple-container { width: 100%; max-width: 440px; display: flex; flex-direction: column; gap: 15px; }

        /* 1. Header (Identity) */
        .card-header { background: #FFF; border-radius: 30px; padding: 35px 20px; text-align: center; box-shadow: 0 8px 30px rgba(0,0,0,0.04); }
        .logo-img { width: 85px; height: 85px; border-radius: 20px; margin-bottom: 15px; object-fit: contain; background: #FBFBFD; border: 1px solid #eee; }
        h1 { font-size: 24px; margin: 0; font-weight: 700; }
        .slogan { color: #86868B; font-size: 14px; margin-top: 8px; line-height: 1.4; }

        /* 2. Search & Select All (Features) */
        .card-search { background: #FFF; border-radius: 25px; padding: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.02); }
        .search-input { width: 100%; padding: 14px 18px; border-radius: 15px; border: 1px solid #D2D2D7; outline: none; box-sizing: border-box; font-size: 15px; background: #FBFBFD; }

        /* 3. Staff List (Triple View) */
        .card-list { background: #FFF; border-radius: 30px; padding: 10px; box-shadow: 0 8px 30px rgba(0,0,0,0.04); }
        .staff-item { display: flex; align-items: center; padding: 15px; border-radius: 22px; text-decoration: none; color: inherit; transition: 0.2s; margin-bottom: 5px; }
        .staff-item:hover { background: #FBFBFD; transform: scale(1.01); }
        .photo { width: 60px; height: 60px; border-radius: 50%; object-fit: cover; margin-right: 15px; border: 2px solid #FFF; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
        .info { flex: 1; text-align: left; }
        .name { font-weight: 600; font-size: 16px; margin: 0; }
        .job { font-size: 12px; color: #86868B; margin-top: 2px; }
        .pills { display: flex; gap: 4px; margin-top: 8px; flex-wrap: wrap; }
        .pill { font-size: 9px; padding: 3px 8px; background: #F2F2F7; border-radius: 6px; font-weight: 600; text-transform: uppercase; }
        .chevron { color: #C7C7CC; font-size: 20px; }
    </style>
</head>
<body>

<div class="triple-container">
    <div class="card-header">
        <img id="bLogo" src="" class="logo-img" style="display:none;">
        <h1 id="bName">Loading...</h1>
        <p id="bSlogan" class="slogan"></p>
    </div>

    <div class="card-search">
        <input type="text" id="sIn" class="search-input" placeholder="Search for a specialist..." onkeyup="filter()">
    </div>

    <div class="card-list">
        <div id="sList"></div>
    </div>
</div>

<script>
    function load() {
        const cp = JSON.parse(localStorage.getItem('company_profile') || '{}');
        const st = JSON.parse(localStorage.getItem('master_staff') || '[]');

        if(cp.name) {
            document.getElementById('bName').innerText = cp.name;
            document.getElementById('pTitle').innerText = cp.name;
            document.getElementById('bSlogan').innerText = cp.slogan || "Select a professional";
            if(cp.logo) {
                const img = document.getElementById('bLogo');
                img.src = cp.logo;
                img.style.display = 'inline-block';
            }
        }

        const list = document.getElementById('sList');
        const published = st.filter(s => s.published === true);

        if(published.length === 0) {
            list.innerHTML = '<p style="padding:20px; color:#999; text-align:center;">No specialists found.</p>';
            return;
        }

        list.innerHTML = published.map(s => `
            <a href="payment.html?id=${s.id}" class="staff-item" data-name="${s.nName.toLowerCase()}">
                <img src="${s.img}" class="photo">
                <div class="info">
                    <p class="name">${s.nName}</p>
                    <p class="job">${s.job}</p>
                    <div class="pills">
                        ${(s.days || []).map(d => `<span class="pill">${d}</span>`).join('')}
                    </div>
                </div>
                <span class="chevron">â€º</span>
            </a>
        `).join('');
    }

    function filter() {
        const val = document.getElementById('sIn').value.toLowerCase();
        document.querySelectorAll('.staff-item').forEach(card => {
            const name = card.getAttribute('data-name');
            card.style.display = name.includes(val) ? 'flex' : 'none';
        });
    }

    window.onload = load;
</script>
</body>
</html>
